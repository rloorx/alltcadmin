<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/common.css">
    <title>스터디룸현황화면</title>

    <script>
        function multiSelect() {
            var div = document.getElementById("Div");
            if (div.style.visibility === "visible") {
                div.style.visibility = "hidden";
            } else {
                div.style.visibility = "visible";
            }
        }    
    </script>
</head>/
<body>
    <div id="seats">
        <div class="wrap">
            <header class="aside-header">
                <h1><img src="./img/logo.png" alt="올티칭 스터디카페"></h1>
                <ul>
                    <li>
                        <a href="#"><img src="./img/icon-dashboard.png"><span>대시보드</span></a>
                    </li>
                    <li>
                        <a href="#"><img src="./img/icon-chart.png"><span>매출 관리</span></a>
                    </li>
                    <li>
                        <a href="#"><img src="./img/icon-store.png"><span>매장 관리</span></a>
                    </li>
                    <li class="on">
                        <a href="#"><img src="./img/icon-group-white.png"><span>회원 관리</span></a>
                        <ul>
                            <li><a href="#"><img src="./img/icon-man.png">회원 관리</a></li>
                            <li><a href="#"><img src="./img/icon-enter.png">입·퇴실 관리</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#"><img src="./img/icon-item.png"><span>이용상품</span></a>
                    </li>
                    <li>
                        <a href="#"><img src="./img/icon-seat.png"><span>실시간 이용현황</span></a>
                    </li>
                    <li>
                        <a href="#"><img src="./img/icon-event.png"><span>이벤트 배너 관리</span></a>
                    </li>
                    <li class="mobile">
                        <a href="#"><img src="./img/icon-my.png"><span>마이페이지</span></a>
                    </li>
                    <li class="mobile">
                        <a href="#"><img src="./img/icon-logout.png"><span>로그아웃</span></a>
                    </li>
                </ul>
            </header>
            <main class="main">
                <div class="main-header">
                    <div class="in">
                        <span>광명 직영점 (관리자)님, 환영합니다!</span>
                        <div class="my">
                            <a href="#"><img src="./img/icon-my.png"><span>마이페이지</span></a>
                        </div>
                        <div class="logout">
                            <a href="#"><img src="./img/icon-logout.png"><span>로그아웃</span></a>
                        </div>
                        <div class="mobile-header">
                            <h1><img src="./img/logo.png"></h1>
                            <div class="mobile-menu">
                                <img src="./img/icon-menu.png">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="in">
                    <h2><img src="./img/icon-seat-30px.png"><span>실시간 이용현황</span></h2>
                    <div class="now-tabarea">
                        <ul>
                            <li>좌석 관리</li>
                            <li class="on">스터디룸 관리</li>
                            <li>사물함 관리</li>
                        </ul>
                    </div>
                    <div class="seats-tit">
                        <h3>좌석 현황</h3>
                        <!-- <button class="new-btn">
                            <img src="./img/icon-add.png"><span>좌석/시설 등록</span>
                        </button> -->
                    </div>
                    <div class="box-area">
                        <div class="box chair">
                            <div class="box-top">
                                <span>좌석</span>
                                <img src="./img/icon-chair.png">
                            </div>
                            <div class="box-bottom">
                                <span>사용 / 전체</span>
                            </div>
                            <div class="box-num">
                                <h3>13 / 20</h3>
                            </div>
                        </div>
                        <div class="box room">
                            <div class="box-top">
                                <span>스터디룸</span>
                                <img src="./img/icon-studyroom.png">
                            </div>
                            <div class="box-bottom">
                                <span>사용 / 전체</span>
                            </div>
                            <div class="box-num">
                                <h3>13 / 20</h3>
                            </div>
                        </div>
                        <div class="box locker">
                            <div class="box-top">
                                <span>사물함</span>
                                <img src="./img/icon-locker.png">
                            </div>
                            <div class="box-bottom">
                                <span>사용 / 전체</span>
                            </div>
                            <div class="box-num">
                                <h3>13 / 20</h3>
                            </div>
                        </div>
                    </div>
                    <div class="search-area">
                        <div class="search-box">
                            <input type="text" placeholder="검색어(이름, 연락처)를 입력해 주세요.">
                            <img src="./img/icon-search.png">
                        </div>
                    </div>
                    <!--<div class="tab-area">
                        <ul>
                            <li class="on">5층</li>
                            <li>6층</li>
                        </ul>
                    </div> 층별 구분 탭-->
                    <div class="seats-area room">
                        <div class="seats-modal on"></div>
                        <h3>스터디룸 예약현황</h3>
                        <div class="cal-area">
                            <div class="cal-select">
                                <div class="calendar-container">
                                    <div class="nav-container">
                                        <button id="prev-month" style="width: 50px;">◀</button>
                                        <span id="month-year" style="width: 200px; font-size: var(--fonth3); font-weight: 700;"></span>
                                        <button id="next-month" style="width: 50px;">▶</button>
                                    </div>
                                    <div id="calendar" class="calendar-grid"></div>
                                </div>
                            </div>
                        </div>

                        <!-- 스터디룸 상세팝업 -->
                        <div class="pop-up seats-pop room on">
                            <div class="seats-name">
                                <h3>예약 상세 정보</h3>
                            </div>
                            <div class="pop-bottombtn">
                                <button class="room-time disabled">시간 연장</button>
                                <button class="room-change">스터디룸 이동</button>
                                <button class="exit">퇴실 처리</button>
                                <button class="close">닫기</button>
                            </div>
                            <div class="room-tab">
                                <ul>
                                    <li class="on">스터디룸1</li>
                                    <li>스터디룸2</li>
                                </ul>
                            </div>
                            <div class="user-area-layout">
                                <div class="seats-user-area room">
                                    <h4><span>사용중</span>현재 이용중인 예약</h4>
                                    <div class="box">
                                        <span>이름</span>
                                        <span>강예슬</span>
                                    </div>
                                    <div class="box">
                                        <span>연락처</span>
                                        <span>010-1234-1234</span>
                                    </div>
                                    <div class="box">
                                        <span>좌석 상태</span>
                                        <span>입실<br>(2025-09-01 10:00:00)</span>
                                    </div>
                                    <div class="box">
                                        <span>예약시간</span>
                                        <span class="red">16:00 ~ 20:00 (4시간)</span>
                                    </div>
                                    <div class="box">
                                        <span>예약일</span>
                                        <span>2025.07.09</span>
                                    </div>
                                </div>
                            </div>
                            <div class="room-list">
                                <div class="room-list-top">
                                    <h4>7월 22일 예약내역</h4>
                                    <button><img src="./img/icon-add.png"><span>스터디룸 예약</span></button>
                                </div>
                                <div class="table-layout"> 
                                    <table>
                                        <thead>
                                            <tr>
                                                <td>예약 시간</td>    
                                                <td>상품명</td>
                                                <td>이름</td>
                                                <td>예약 삭제</td>
                                                <td>예약일</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="past-table">
                                                <td>12:00 ~ 16:00</td>
                                                <td>스터디룸 4시간</td>
                                                <td>김예지</td>
                                                <td>x</td>
                                                <td>2025/07/21<span class="kiosk">키오스크</span></td>
                                            </tr>
                                            <tr class="current-table">
                                                <td>16:00 ~ 20:00<span class="current">사용중</span></td>
                                                <td>스터디룸 4시간</td>
                                                <td>김예지</td>
                                                <td>x</td>
                                                <td>2025/07/21<span class="kiosk">키오스크</span></td>
                                            </tr>
                                            <tr>
                                                <td>20:00 ~ 22:00</td>
                                                <td>스터디룸 2시간</td>
                                                <td>김예지</td>
                                                <td>x</td>
                                                <td>2025/07/22<span>관리자</span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="room-info">
                                    <div class="toast-pop"><!--시간연장 비활성화일때 클릭시 노출-->
                                        <span class="state-bar">이미 다음 예약이 있어 연장 불가합니다.</span>
                                    </div>
                                    <span class="state-bar state03">수동으로 추가한 예약 건은 장비 관리 메뉴에서 직접 문을 열어 주셔야 합니다.</span>
                                </div>
                            </div>
                        </div>
 
                        <!-- 예약삭제 확인 -->
                        <div class="pop-up seats-confirm-pop room">
                            <div class="seats-name">
                                <h3>예약 삭제 확인</h3>
                            </div>
                            <div class="pop-bottombtn">
                                <button class="cancel">취소</button>
                                <button class="save">예약 삭제</button>
                            </div>
                            <div class="pop-area">
                                <h3>스터디룸2</h3>
                                <span><strong>예약시간 :</strong> 20:00 ~ 22:00</span>
                                <h3 class="small">해당 예약을 삭제하시겠습니까?</h3>
                                <span class="red">삭제된 예약은 복구할 수 없습니다.</span>
                            </div>           
                        </div>

                        <!-- 좌석이동팝업 : 좌석 이동 성공/ 퇴실처리 팝업 : 퇴실 성공 -->
                        <div class="pop-up seats-fin-pop">
                            <div class="pop-bottombtn">
                                <button class="save">확인</button>
                            </div>
                            
                            <div class="pop-area">
                                <img src="./img/check-img.png">
                                <h3>예약 삭제되었습니다.</h3>
                            </div>           
                        </div>

                        <!-- 시간연장 팝업 : 연장시간 선택(활성화된 버튼 클릭했을때) -->
                        <div class="pop-up room-timepop room">
                            <div class="seats-name">
                                <h3>연장시간 선택</h3>
                            </div>
                            <div class="pop-bottombtn">
                                <button class="cancel">취소</button>
                                <button class="save">연장</button>
                            </div>
                            <div class="pop-area">
                                <span>연장시간 선택</span>
                                <select id="time-room">
                                    <option value="default">선택</option>
                                    <option value="room-time01">20:30(30분 연장)</option>
                                    <option value="room-time02">21:00(1시간 연장)</option>
                                    <option value="room-time03">21:30(1시간 30분 연장)</option>
                                </select>
                            </div>           
                        </div>
                        
                        <!-- 퇴실처리팝업 : 퇴실 처리 안내 -->
                        <div class="pop-up exit-confirm-pop">
                            <div class="seats-name">
                                <h3>스터디룸2</h3>
                            </div>
                            <div class="pop-bottombtn">
                                <button class="cancel">취소</button>
                                <button class="save">퇴실처리</button>
                            </div>
                            <div class="pop-area">
                                <span><strong>예약 시간 :</strong> 20:00 ~ 22:00</span>
                                <h3><span>스터디룸2 </span>좌석을 퇴실처리 하시겠습니까?</h3>
                            </div>           
                        </div>


                    </div>
                </div>
            </main>
        </div>

        <div class="modal on"></div>

        <!-- 스터디룸 이동 선택 -->
        <div class="pop-up rooms-select-pop" style="display: none;">
            <div class="seats-name">
                <h3>스터디룸 이동 선택</h3>
                <span>현재 예약(16:00 ~ 20:00)을 이동할 스터디룸을 선택하세요.</span>
            </div>
            <div class="pop-bottombtn">
                <button class="cancel">취소</button>
                <button class="save">이동</button>
            </div>
            <div class="pop-area">
                <div class="room-box on">
                    <span>스터디룸1</span>
                    <span class="room-state room-state01">공실</span>
                </div>
                <div class="room-box">
                    <span>스터디룸3</span>
                    <span class="room-state room-state02">예약중</span>
                </div>

            </div>           
        </div>


        <!-- 좌석이동팝업 : 좌석 이동 확인 -->
        <div class="pop-up room-confirm-pop" style="display: none;">
            <div class="seats-name">
                <h3>스터디룸2 이동 확인</h3>
            </div>
            <div class="pop-bottombtn">
                <button class="cancel">취소</button>
                <button class="save">이동</button>
            </div>
            <div class="pop-area">
                <h3>스터디룸2 → 스터디룸1</h3>
                <span class="big">선택한 좌석을 변경합니다.</span>
                <span>좌석 이동 시 기존 좌석 이용은 즉시 종료되며,<br>새 좌석에서 바로 이용이 시작됩니다.</span>
                <h3>좌석 이동을 하시겠습니까?</h3>
            </div>           
        </div>

        <!-- 입실처리 팝업 -->
        <div class="pop-up seats-enter">
            <div class="pop-top">
                <h2><span>스터디룸2</span> 입실</h2>
                <span>예약 날짜 :2025/08/01</span>
            </div>
            <div class="pop-area">
                <div class="num">
                    <span>연락처</span>
                    <input type="text" placeholder="예 : 010-1234-1234">
                </div>
                <button class="view">조회</button>
            </div>
            <div class="view-area" style="display: block;">
                <!-- <div class="item">
                    <span>상품</span>
                    <input type="text" value="스터디룸 2시간권">
                    <div class="no-item" style="display: none;">
                        <span>결제내역 없음</span>
                        <select id="room-items">
                            <option value="default">선택</option>
                            <option value="item01">스터디룸 1시간</option>
                            <option value="item02">스터디룸 2시간</option>
                            <option value="item03">스터디룸 3시간</option>
                            <option value="item04">스터디룸 4시간</option>
                            <option value="item05">스터디룸 5시간</option>
                            <option value="item06">스터디룸 6시간</option>
                        </select>
                    </div>
                </div> -->
                <div class="item">
                    <span>이용 시간</span>
                    <select id="room-time">
                        <option value="default">단위 선택</option>
                        <option value="time01">1시간</option>
                        <option value="time02">2시간</option>
                        <option value="time03">3시간</option>
                        <option value="time04">4시간</option>
                        <option value="time05">5시간</option>
                        <option value="time06">6시간</option>
                    </select>
                </div>
                <div class="item multiselect">
                    <span>시작 시간 선택</span>
                    <select id="room-time">
                        <option value="default">시간 선택</option>
                        <option value="time01">13:00</option>
                        <option value="time02">14:00</option>
                        <option value="time03">15:00</option>
                        <option value="time04">16:00</option>
                        <option value="time05">17:00</option>
                    </select>
                    <!-- <form name="form1">
                        <table style="cursor:pointer" onClick="multiSelect('OPEN')">
                            <tbody>
                                <tr>
                                    <td>시간 선택 <img src="./img/icon-arrow-bottom.png"></td>
                                </tr>
                            </tbody>
                        </table>

                        <div id="Div" style="position:absolute;visibility:hidden;">
                            <ul>
                                <li><input type="checkbox" name="chk1" id="chk1">13:00 ~ 14:00</li>
                                <li><input type="checkbox" name="chk2" id="chk2">14:00 ~ 15:00</li>
                                <li><input type="checkbox" name="chk3" id="chk3">15:00 ~ 16:00</li>
                                <li><input type="checkbox" name="chk4" id="chk4">16:00 ~ 17:00</li>
                                <li><input type="checkbox" name="chk5" id="chk5">17:00 ~ 18:00</li>
                                <li><input type="checkbox" name="chk6" id="chk6">18:00 ~ 19:00</li>
                                <li><input type="checkbox" name="chk7" id="chk7">19:00 ~ 20:00</li>
                            </ul>       
                        </div>
                    </form> -->
                </div>
                <div class="item">
                    <span>예약 시간</span>
                    <h4>13:00 ~ 15:00</h4>
                </div>
                <span class="state-bar">
                    입실 가능한 상태입니다. <strong>등록</strong> 버튼을 눌러 입실처리를 완료하세요. <br>수동으로 추가한 예약 건은 장비 관리 메뉴에서 직접 문을 열어 주셔야 합니다.
                </span>
                <span class="state-bar state02" style="display: none;">
                    선택하신 시간에 이미 예약이 있어 입실이 불가능합니다. <br>다른 이용 가능 시간대를 선택해 주세요.
                </span>
            </div>
            <div class="pop-bottombtn">
                <button type="button" class="cancel">취소</button>
                <button type="button" class="save disabled">등록</button>
            </div>
        </div>
 
        <!-- 좌석이동 완료 팝업, 입실처리 완료 팝업 -->
        <div class="pop-up fin" style="display: none;">
            <div class="pop-bottombtn">
                <button class="save">확인</button>
            </div>
            
            <div class="pop-area">
                <img src="./img/check-img.png">
                <h3>좌석 이동 처리되었습니다.</h3>
            </div>           
        </div>

    </div>



    <script>
        document.querySelectorAll('.aside-header ul > li > a').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
            e.preventDefault();

            const parentLi = this.parentElement;
            const img = this.querySelector('img');

            document.querySelectorAll('.aside-header ul > li').forEach(li => {
                li.classList.remove('on');

                const liImg = li.querySelector('a > img');
                if (liImg) {
                // -white 제거
                liImg.src = liImg.src.replace('-white', '');
                }
            });

            const isNowOn = parentLi.classList.toggle('on');

            // -white 이미지로 교체
            if (isNowOn && img) {
                const src = img.src;
                if (!src.includes('-white')) {
                const newSrc = src.replace(/(\.png|\.jpg|\.jpeg|\.gif)$/i, '-white$1');
                img.src = newSrc;
                }
            }
            });
        });

        document.querySelector('.mobile-menu').addEventListener('click', function () {
            document.querySelector('.modal')?.classList.add('on');
            document.querySelector('.aside-header')?.classList.add('on');
        });
        document.querySelector('.modal').addEventListener('click', function () {
            this.classList.remove('on');
            document.querySelector('.aside-header')?.classList.remove('on');
        });

        document.querySelector('.pop-up.seats-pop .pop-bottombtn .close')?.addEventListener('click', () => {
            document.querySelector('.pop-up.seats-pop')?.classList.remove('on');
            document.querySelector('.seats-modal')?.classList.remove('on');
        });

        document.addEventListener("DOMContentLoaded", function () {
            const calendar = document.getElementById("calendar");
            const monthYear = document.getElementById("month-year");
            const prevBtn = document.getElementById("prev-month");
            const nextBtn = document.getElementById("next-month");

            let currentDate = new Date();
            let today = new Date();
            let selectedDay = null;

            function renderCalendar(date) {
                const year = date.getFullYear();
                const month = date.getMonth();
                monthYear.textContent = `${year}년 ${month + 1}월`;

                const firstDay = new Date(year, month, 1).getDay();
                const lastDate = new Date(year, month + 1, 0).getDate();
                const prevLastDate = new Date(year, month, 0).getDate();
                const nextMonthDays = 42 - (firstDay + lastDate);

                const daysOfWeek = ["일", "월", "화", "수", "목", "금", "토"];
                let header = daysOfWeek.map((day, index) => {
                    const weekendClass = (index === 0 || index === 6) ? 'weekend' : ''; 
                    return `<div class='day-header ${weekendClass}'>${day}</div>`;
                }).join("");
                
                let days = "";
                for (let i = firstDay; i > 0; i--) {
                    const isPast = new Date(year, month - 1, prevLastDate - i + 1) < today ? "past" : "";
                    days += `<div class='day prev-month ${isPast}'>${prevLastDate - i + 1}</div>`;
                }
                for (let i = 1; i <= lastDate; i++) {
                    const isToday =
                        i === today.getDate() &&
                        month === today.getMonth() &&
                        year === today.getFullYear()
                            ? "today"
                            : "";
                    const isPast =
                        new Date(year, month, i) < today ? "past" : "clickable";
                    const isSelected = selectedDay === `${year}-${month + 1}-${i}` ? "selected" : "";
                    days += `<div class='day ${isToday} ${isPast} ${isSelected}' data-date='${year}-${month + 1}-${i}'>${i}</div>`;
                }
                for (let i = 1; i <= nextMonthDays; i++) {
                    const isPast = new Date(year, month + 1, i) < today ? "past" : "";
                    days += `<div class='day next-month ${isPast}'>${i}</div>`;
                }
                calendar.innerHTML = header + days;

                document.querySelectorAll(".clickable").forEach(day => {
                    day.addEventListener("click", function () {
                        selectedDay = this.dataset.date;
                        renderCalendar(currentDate);
                    });
                });
            }

            prevBtn.addEventListener("click", function () {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar(currentDate);
            });
            nextBtn.addEventListener("click", function () {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar(currentDate);
            });

            renderCalendar(currentDate);
        });

        document.addEventListener('DOMContentLoaded', () => {
            const disabledBtn = document.querySelector('.room-time.disabled');
            const toast = document.querySelector('.toast-pop');

            disabledBtn.addEventListener('click', () => {
                toast.classList.add('show');

                setTimeout(() => {
                toast.classList.remove('show');
                }, 1000);
            });
        });


        (function(){
  const targetSelector = '.state-bar.state02';
  const itemsSelector = '.pop-up.seats-enter .view-area .item>h4';

  function updateDashed() {
    const bar = document.querySelector(targetSelector);
    if (!bar) return;
    const isBlock = window.getComputedStyle(bar).display === 'block';
    document.querySelectorAll(itemsSelector).forEach(el => {
      el.classList.toggle('dashed', isBlock);
    });
  }

  // 초기 실행
  document.addEventListener('DOMContentLoaded', updateDashed);
  // 안전망: DOMContentLoaded 이후에도 바로 한 번 실행
  if (document.readyState === 'complete' || document.readyState === 'interactive') updateDashed();

  // 변경 감시: .state-bar.state02 요소의 class/style 변경 감지
  function observeBar() {
    const bar = document.querySelector(targetSelector);
    if (!bar) return;
    const mo = new MutationObserver(() => updateDashed());
    mo.observe(bar, { attributes: true, attributeFilter: ['style','class'] });
    // 경우에 따라 .state-bar.state02 요소가 동적으로 바뀔 수 있으니 바 자체의 생성도 관찰
    const bodyObserver = new MutationObserver(() => {
      if (!document.querySelector(targetSelector)) return;
      // 이미 연결되어 있다면 중복 관찰 방지
      // (간단히 다시 호출해도 안전하게 동작함)
      updateDashed();
    });
    bodyObserver.observe(document.body, { childList: true, subtree: true });
  }

  // 초기 관찰 설정 (DOMContentLoaded 후)
  document.addEventListener('DOMContentLoaded', observeBar);
  if (document.readyState === 'complete' || document.readyState === 'interactive') observeBar();
})();
    </script>
</body>
</html>